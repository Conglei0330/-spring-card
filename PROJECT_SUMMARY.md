# ğŸ‰ é¡¹ç›®åˆ›å»ºå®Œæˆï¼

æ­å–œï¼é©¬å¹´æ–°æ˜¥è´ºå¡ç”Ÿæˆå™¨é¡¹ç›®å·²ç»æˆåŠŸåˆ›å»ºã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
spring-card/
â”œâ”€â”€ ğŸ“„ é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ package.json          # é¡¹ç›®ä¾èµ–é…ç½®
â”‚   â”œâ”€â”€ tsconfig.json         # TypeScript é…ç½®
â”‚   â”œâ”€â”€ next.config.js        # Next.js é…ç½®
â”‚   â”œâ”€â”€ tailwind.config.js    # Tailwind CSS é…ç½®
â”‚   â”œâ”€â”€ postcss.config.js     # PostCSS é…ç½®
â”‚   â”œâ”€â”€ .env.example          # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”‚   â””â”€â”€ .gitignore            # Git å¿½ç•¥æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“š å·¥å…·åº“ (lib/)
â”‚   â”œâ”€â”€ bailian.ts            # ç™¾ç‚¼ SDK å°è£…ï¼ˆæ–‡æ¡ˆç”Ÿæˆ + å›¾ç‰‡ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ canvas.ts             # Canvas åˆæˆå·¥å…·ï¼ˆå‰ç«¯å›¾ç‰‡åˆæˆï¼‰
â”‚   â”œâ”€â”€ oss.ts                # OSS ä¸Šä¼ å·¥å…·ï¼ˆå¯é€‰ï¼‰
â”‚   â””â”€â”€ rate-limit.ts         # é™æµå·¥å…·ï¼ˆé˜²æ»¥ç”¨ï¼‰
â”‚
â”œâ”€â”€ ğŸ¨ React ç»„ä»¶ (components/)
â”‚   â”œâ”€â”€ Header.tsx            # é¡¶éƒ¨æ ‡é¢˜ç»„ä»¶ï¼ˆé©¬å¹´ä¸»é¢˜ï¼‰
â”‚   â”œâ”€â”€ GreetingForm.tsx      # ç”Ÿæˆè¡¨å•ç»„ä»¶ï¼ˆå¯¹è±¡/é£æ ¼/é•¿åº¦/ç½²åï¼‰
â”‚   â”œâ”€â”€ GreetingResult.tsx    # è´ºè¯å±•ç¤ºç»„ä»¶ï¼ˆå¤åˆ¶/æ¢ä¸€æ¡/ç”Ÿæˆå›¾ç‰‡ï¼‰
â”‚   â””â”€â”€ CardPreview.tsx       # è´ºå¡é¢„è§ˆç»„ä»¶ï¼ˆCanvas åˆæˆ + ä¸‹è½½ï¼‰
â”‚
â”œâ”€â”€ ğŸ“„ é¡µé¢ (pages/)
â”‚   â”œâ”€â”€ api/                  # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ greeting.ts       # è´ºè¯ç”Ÿæˆæ¥å£ï¼ˆPOST /api/greetingï¼‰
â”‚   â”‚   â””â”€â”€ card.ts           # å›¾ç‰‡ç”Ÿæˆæ¥å£ï¼ˆPOST /api/cardï¼‰
â”‚   â”œâ”€â”€ index.tsx             # ä¸»é¡µé¢ï¼ˆå•é¡µåº”ç”¨ï¼‰
â”‚   â”œâ”€â”€ _app.tsx              # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ _document.tsx         # HTML æ–‡æ¡£
â”‚
â”œâ”€â”€ ğŸ¨ æ ·å¼ (styles/)
â”‚   â””â”€â”€ globals.css           # å…¨å±€æ ·å¼ï¼ˆé€‚è€åŒ–è®¾è®¡ï¼‰
â”‚
â”œâ”€â”€ ğŸ“– æ–‡æ¡£
â”‚   â”œâ”€â”€ README.md             # å®Œæ•´é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ QUICK_START.md        # å¿«é€Ÿå¯åŠ¨æŒ‡å—
â”‚   â””â”€â”€ PROJECT_SUMMARY.md    # æœ¬æ–‡ä»¶
â”‚
â””â”€â”€ ğŸš€ è„šæœ¬
    â”œâ”€â”€ setup.bat             # Windows åˆå§‹åŒ–è„šæœ¬
    â””â”€â”€ setup.sh              # Linux/Mac åˆå§‹åŒ–è„šæœ¬
```

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### 1. AI èƒ½åŠ›
- **æ–‡æ¡ˆç”Ÿæˆ**ï¼šé˜¿é‡Œäº‘ç™¾ç‚¼ `qwen-max`
  - å¤šç§å¯¹è±¡ï¼šçˆ¸å¦ˆã€äº²å‹ã€åŒäº‹ã€å®¢æˆ·ã€è€å¸ˆã€é•¿è¾ˆ
  - å¤šç§é£æ ¼ï¼šå–œåº†æ¸©æš–ã€æ–‡é›…å¤§æ°”ã€å¹½é»˜é£è¶£ã€ç®€çŸ­ç²¾ç‚¼ã€å››å­—æˆè¯­
  - ä¸‰ç§é•¿åº¦ï¼šçŸ­ï¼ˆ30-40å­—ï¼‰ã€ä¸­ï¼ˆ60-90å­—ï¼‰ã€é•¿ï¼ˆ100-150å­—ï¼‰

- **å›¾ç‰‡ç”Ÿæˆ**ï¼šé˜¿é‡Œäº‘ç™¾ç‚¼ `qwen-vl-max`
  - 9:16 ç«–ç‰ˆé•¿å›¾
  - å›½é£å–œåº†èƒŒæ™¯
  - å‰ç«¯ Canvas åˆæˆï¼ˆæ–‡å­— 100% å‡†ç¡®ï¼‰

### 2. é€‚è€åŒ–è®¾è®¡
- åŸºç¡€å­—å· 18pxï¼ˆæ¯”å¸¸è§„å¤§ï¼‰
- æŒ‰é’®é«˜åº¦ â‰¥ 56pxï¼ˆæ˜“ç‚¹å‡»ï¼‰
- é«˜å¯¹æ¯”åº¦è‰²å½©ï¼ˆçº¢é‡‘é…è‰²ï¼‰
- ç®€åŒ–æ“ä½œæµç¨‹ï¼ˆä¸€é”®ç”Ÿæˆï¼‰
- æ˜ç¡®è§†è§‰åé¦ˆï¼ˆåŠ è½½çŠ¶æ€ï¼‰

### 3. ç§»åŠ¨ç«¯ä¼˜åŒ–
- å“åº”å¼å¸ƒå±€ï¼ˆTailwind CSSï¼‰
- è§¦æ‘¸å‹å¥½ï¼ˆå¤§æŒ‰é’®ã€ç‚¹å‡»åŒºåŸŸï¼‰
- æ”¯æŒé•¿æŒ‰ä¿å­˜å›¾ç‰‡ï¼ˆå…¼å®¹å¾®ä¿¡ï¼‰
- è‡ªåŠ¨æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ

### 4. æŠ€æœ¯äº®ç‚¹
- **å‰åç«¯ä¸€ä½“**ï¼šNext.js API Routes
- **ç±»å‹å®‰å…¨**ï¼šTypeScript å…¨æ ˆ
- **æ ·å¼å·¥ç¨‹åŒ–**ï¼šTailwind CSS + è‡ªå®šä¹‰ CSS
- **Canvas åˆæˆ**ï¼šå‰ç«¯é«˜æ¸…å›¾ç‰‡åˆæˆ
- **é™æµä¿æŠ¤**ï¼šé˜²æ­¢ API æ»¥ç”¨

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ3 æ­¥ï¼‰

### ç¬¬ä¸€æ­¥ï¼šåˆå§‹åŒ–é¡¹ç›®

**Windows ç”¨æˆ·**ï¼š
```bash
cd spring-card
.\setup.bat
```

**Linux/Mac ç”¨æˆ·**ï¼š
```bash
cd spring-card
chmod +x setup.sh
./setup.sh
```

**æˆ–æ‰‹åŠ¨æ‰§è¡Œ**ï¼š
```bash
cd spring-card
npm install
cp .env.example .env.local
```

### ç¬¬äºŒæ­¥ï¼šé…ç½® API Key

ç¼–è¾‘ `.env.local` æ–‡ä»¶ï¼š

```env
DASHSCOPE_API_KEY=sk-your-api-key-here
```

è·å–åœ°å€ï¼š[é˜¿é‡Œäº‘ç™¾ç‚¼æ§åˆ¶å°](https://bailian.console.aliyun.com/)

### ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨é¡¹ç›®

```bash
npm run dev
```

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š[http://localhost:3000](http://localhost:3000)

## ğŸ“ API æ¥å£

### 1. ç”Ÿæˆè´ºè¯ `POST /api/greeting`

**è¯·æ±‚**ï¼š
```json
{
  "target": "çˆ¸å¦ˆ",
  "style": "å–œåº†æ¸©æš–",
  "length": "medium",
  "signature": "å°æ˜"
}
```

**å“åº”**ï¼š
```json
{
  "success": true,
  "data": {
    "text": "çˆ¸å¦ˆæ–°å¹´å¥½ï¼é©¬å¹´åˆ°ï¼Œæ„¿æ‚¨äºŒè€é¾™é©¬ç²¾ç¥...",
    "alt": ["å¤‡é€‰1", "å¤‡é€‰2", "å¤‡é€‰3"],
    "short": "é©¬å¹´å‰ç¥¥ é˜–å®¶å®‰åº·"
  },
  "remaining": 9
}
```

### 2. ç”ŸæˆèƒŒæ™¯å›¾ `POST /api/card`

**è¯·æ±‚**ï¼š
```json
{
  "style": "default"
}
```

**å“åº”**ï¼š
```json
{
  "success": true,
  "data": {
    "imageUrl": "https://xxx.oss-cn-hangzhou.aliyuncs.com/cards/xxx.png",
    "style": "default"
  },
  "remaining": 2
}
```

## ğŸ¯ å·¥ä½œæµç¨‹

1. **ç”¨æˆ·æ‰“å¼€ç½‘ç«™** â†’ çœ‹åˆ°ä¸»é¢˜é¡µé¢
2. **ç‚¹å‡»"ä¸€é”®ç”Ÿæˆè´ºè¯"** â†’ è°ƒç”¨ `/api/greeting` â†’ 2-5 ç§’è¿”å›
3. **æŸ¥çœ‹è´ºè¯** â†’ å¯å¤åˆ¶ã€æ¢ä¸€æ¡
4. **ç‚¹å‡»"ç”Ÿæˆè´ºå¡é•¿å›¾"** â†’ è°ƒç”¨ `/api/card` â†’ 10-20 ç§’è¿”å›èƒŒæ™¯å›¾
5. **å‰ç«¯ Canvas åˆæˆ** â†’ èƒŒæ™¯å›¾ + è´ºè¯ + ç½²å â†’ ç”Ÿæˆæœ€ç»ˆå›¾ç‰‡
6. **ä¿å­˜å›¾ç‰‡** â†’ ç‚¹å‡»ä¸‹è½½æˆ–é•¿æŒ‰ä¿å­˜

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### Canvas åˆæˆæµç¨‹

```typescript
// 1. åˆ›å»º Canvas (1080Ã—1920)
const canvas = document.createElement('canvas');
canvas.width = 1080;
canvas.height = 1920;

// 2. ç»˜åˆ¶èƒŒæ™¯å›¾
ctx.drawImage(backgroundImage, 0, 0, 1080, 1920);

// 3. ç»˜åˆ¶åŠé€æ˜ç™½åº•
ctx.fillStyle = 'rgba(255, 255, 255, 0.88)';
roundRect(ctx, x, y, width, height, radius);
ctx.fill();

// 4. ç»˜åˆ¶æ ‡é¢˜ï¼ˆçŸ­å¥ï¼‰
ctx.font = 'bold 56px STKaiti';
ctx.fillText(shortTitle, x, y);

// 5. ç»˜åˆ¶è´ºè¯ï¼ˆè‡ªåŠ¨æ¢è¡Œï¼‰
const lines = wrapText(ctx, greetingText, maxWidth);
lines.forEach((line, i) => {
  ctx.fillText(line, x, y + i * lineHeight);
});

// 6. ç»˜åˆ¶ç½²å
ctx.fillText(`â€”â€” ${signature}`, x, y);

// 7. å¯¼å‡º PNG
canvas.toBlob(blob => {
  // ä¸‹è½½æˆ–ä¿å­˜
}, 'image/png');
```

### é™æµæœºåˆ¶

```typescript
// å†…å­˜é™æµï¼ˆç”Ÿäº§å»ºè®®ç”¨ Redisï¼‰
const rateLimitStore = new Map<string, RateLimitEntry>();

// æ£€æŸ¥é™æµ
const rateLimit = checkRateLimit(ip, limit, windowMs);

if (!rateLimit.allowed) {
  return res.status(429).json({ error: 'è¯·æ±‚è¿‡å¤š' });
}
```

## ğŸ“¦ éƒ¨ç½²å»ºè®®

### Vercelï¼ˆæ¨èï¼Œæœ€ç®€å•ï¼‰
1. å¯¼å…¥ GitHub ä»“åº“
2. é…ç½®ç¯å¢ƒå˜é‡
3. ä¸€é”®éƒ¨ç½²

### é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—ï¼ˆå›½å†…é€Ÿåº¦å¿«ï¼‰
```bash
npm install -g @serverless-devs/s
s deploy
```

### Dockerï¼ˆçµæ´»éƒ¨ç½²ï¼‰
```bash
docker build -t spring-card .
docker run -p 3000:3000 --env-file .env.local spring-card
```

## âš ï¸ é‡è¦æç¤º

### æˆæœ¬é¢„ä¼°
- è´ºè¯ç”Ÿæˆï¼šçº¦ 0.001 å…ƒ/æ¬¡
- å›¾ç‰‡ç”Ÿæˆï¼šçº¦ 0.05-0.1 å…ƒ/æ¬¡
- å»ºè®®è®¾ç½®æ¯æ—¥é¢„ç®—ä¸Šé™

### å®‰å…¨å»ºè®®
- âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç† API Key
- âœ… å¯ç”¨é™æµï¼ˆé˜²æ»¥ç”¨ï¼‰
- âœ… ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ HTTPS
- âŒ ä¸è¦æŠŠ API Key æäº¤åˆ° Git

### æ€§èƒ½ä¼˜åŒ–
- å›¾ç‰‡ç”Ÿæˆè¾ƒæ…¢ï¼ˆ10-20ç§’ï¼‰ï¼Œéœ€å‰ç«¯æ˜¾ç¤ºè¿›åº¦
- è€ƒè™‘å¢åŠ ç¼“å­˜å±‚ï¼ˆRedisï¼‰
- OSS å­˜å‚¨å¯å‡å°‘é‡å¤ç”Ÿæˆ

## ğŸ› æ•…éšœæ’æŸ¥

| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|----------|
| API è°ƒç”¨å¤±è´¥ | æ£€æŸ¥ `.env.local` ä¸­çš„ `DASHSCOPE_API_KEY` |
| å›¾ç‰‡ç”Ÿæˆå¾ˆæ…¢ | AI æ¨¡å‹æ­£å¸¸éœ€ 10-20 ç§’ï¼Œè€å¿ƒç­‰å¾… |
| å¾®ä¿¡å†…æ— æ³•ä¸‹è½½ | æç¤ºç”¨æˆ·"é•¿æŒ‰å›¾ç‰‡ä¿å­˜" |
| npm install å¤±è´¥ | å°è¯•æ·˜å®é•œåƒï¼š`npm install --registry=https://registry.npmmirror.com` |

## ğŸ“š ä¸‹ä¸€æ­¥

- [ ] å¯åŠ¨å¼€å‘æœåŠ¡å™¨å¹¶æµ‹è¯•
- [ ] è‡ªå®šä¹‰æ ·å¼ï¼ˆ`styles/globals.css`ï¼‰
- [ ] è°ƒæ•´ AI æç¤ºè¯ï¼ˆ`lib/bailian.ts`ï¼‰
- [ ] æ·»åŠ æ›´å¤šèƒŒæ™¯é£æ ¼
- [ ] éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®åŸºäºä»¥ä¸‹æŠ€æœ¯æ„å»ºï¼š
- [Next.js](https://nextjs.org/) - React å…¨æ ˆæ¡†æ¶
- [Tailwind CSS](https://tailwindcss.com/) - CSS æ¡†æ¶
- [é˜¿é‡Œäº‘ç™¾ç‚¼](https://bailian.console.aliyun.com/) - AI èƒ½åŠ›
- [TypeScript](https://www.typescriptlang.org/) - ç±»å‹å®‰å…¨

---

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼é©¬å¹´å¤§å‰ï¼Œé¾™é©¬ç²¾ç¥ï¼ğŸ´âœ¨**

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒï¼š
- å®Œæ•´æ–‡æ¡£ï¼š[README.md](README.md)
- å¿«é€Ÿå¼€å§‹ï¼š[QUICK_START.md](QUICK_START.md)
